{"ast":null,"code":"import { ElementRef } from '@angular/core';\nimport { faLocationPin, faPlay, faRotateRight } from '@fortawesome/free-solid-svg-icons';\nimport { PitchDetector } from 'pitchy';\nimport { notes } from '../shared/notes';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/material/button\";\nimport * as i3 from \"@angular/flex-layout/flex\";\nimport * as i4 from \"@fortawesome/angular-fontawesome\";\n\nfunction TunerComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 41)(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"right\", ctx_r0.note == \"E4\" || ctx_r0.note == \"A4\" || ctx_r0.note == \"D5\" || ctx_r0.note == \"G5\" || ctx_r0.note == \"B5\" || ctx_r0.note == \"E6\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.note, \" \");\n  }\n}\n\nfunction TunerComponent_button_65_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 42);\n    i0.ɵɵlistener(\"click\", function TunerComponent_button_65_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.start());\n    });\n    i0.ɵɵelement(1, \"fa-icon\", 4);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"icon\", ctx_r1.faPlay);\n  }\n}\n\nfunction TunerComponent_button_66_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 42);\n    i0.ɵɵlistener(\"click\", function TunerComponent_button_66_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.refresh());\n    });\n    i0.ɵɵelement(1, \"fa-icon\", 4);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"icon\", ctx_r2.faRotateRight);\n  }\n}\n\nexport let TunerComponent = /*#__PURE__*/(() => {\n  class TunerComponent {\n    constructor(el) {\n      this.el = el;\n      this.faRotateRight = faRotateRight;\n      this.faPlay = faPlay;\n      this.faLocation = faLocationPin;\n      this.playing = false;\n      this.indicator = false;\n      this.standard = 440;\n      this.strings = {\n        A4: false,\n        E4: false,\n        D5: false,\n        G5: false,\n        B5: false,\n        E6: false\n      };\n      this.notes = notes;\n    }\n\n    ngOnInit() {\n      /*\r\n        setTimeout(() => {\r\n          this.note = 'A4';\r\n          this.strings.A4 = true;\r\n        }, 1000);\r\n        setTimeout(() => {\r\n          this.note = 'A5';\r\n        }, 4000);\r\n        setTimeout(() => {\r\n          this.note = 'E4';\r\n          this.strings.E4 = true;\r\n                }, 8000);\r\n        */\n    }\n\n    start() {\n      console.log(\"start\");\n      this.audioContext = new window.AudioContext();\n      this.analyserNode = this.audioContext.createAnalyser();\n      navigator.mediaDevices.getUserMedia({\n        audio: true\n      }).then(stream => {\n        this.audioContext.createMediaStreamSource(stream).connect(this.analyserNode);\n        const detector = PitchDetector.forFloat32Array(this.analyserNode.fftSize);\n        const input = new Float32Array(detector.inputLength);\n        this.updatePitch(this.analyserNode, detector, input, this.audioContext.sampleRate);\n      });\n      this.playing = true;\n    }\n\n    refresh() {\n      this.playing = false;\n      window.location.reload();\n    }\n\n    updatePitch(analyserNode, detector, input, sampleRate) {\n      analyserNode.getFloatTimeDomainData(input);\n      const [pitch, clarity] = detector.findPitch(input, sampleRate);\n      setTimeout(() => this.updatePitch(analyserNode, detector, input, sampleRate), 100);\n\n      if (pitch * 4 > 200 && pitch * 4 < 2000) {\n        this.pitch = Math.round(pitch * 4);\n        this.clarity = Math.round(clarity * 100);\n        this.getNotes(this.pitch);\n        this.detectString();\n      }\n    }\n\n    getNotes(frequency) {\n      if (this.clarity > 95) {\n        this.distance = Math.round(Math.log2(Math.pow(frequency / this.standard, 12)) * 10) / 10;\n        this.margin = Math.round((this.distance - Math.round(this.distance)) * 10) / 10;\n        this.note = this.notes[(Math.round(this.distance) + 12) % 12] + (Math.ceil((this.distance - 2) / 12) + 4);\n        this.note2 = this.notes[(Math.round(this.distance) + 12) % 12];\n      } else {\n        this.note;\n      }\n    }\n\n    detectString() {\n      if (this.margin == 0) {\n        this.indicator = true;\n      } else {\n        this.indicator = false;\n      }\n\n      if (this.margin == 0) {\n        this.strings[this.note] = true;\n      }\n\n      if (this.margin > 0.1 || this.margin < -0.1) {\n        this.strings[this.note] = false;\n      }\n    }\n\n  }\n\n  TunerComponent.ɵfac = function TunerComponent_Factory(t) {\n    return new (t || TunerComponent)(i0.ɵɵdirectiveInject(i0.ElementRef));\n  };\n\n  TunerComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TunerComponent,\n    selectors: [[\"app-tuner\"]],\n    decls: 67,\n    vars: 37,\n    consts: [[1, \"container\"], [\"fxFlex\", \"100\", \"fxFlexOffset\", \"0\", \"fxFlexOffset.gt-xs\", \"25\", \"fxFlex.gt-xs\", \"50\", \"fxLayout\", \"row wrap\", \"fxFlex.gt-md\", \"30\", \"fxFlexOffset.gt-md\", \"35\", 1, \"content\"], [\"fxLayout\", \"row wrap\", \"fxLayoutAlign\", \"center center\", \"fxFlex\", \"50\", \"fxFlexOffset\", \"25\", 1, \"distance\"], [\"fxFlex\", \"100\", 1, \"indicator\"], [3, \"icon\"], [\"fxFlex\", \"100\", \"fxLayoutAlign\", \"space-between\", \"fxFlexLayout\", \"row wrap\", 1, \"indicator-line\"], [\"fxFlex\", \"\", 1, \"dash\"], [\"fxLayoutAlign\", \"center center\", \"fxFlex\", \"50\", \"fxFlexOffset\", \"25\", 1, \"note-container\"], [\"class\", \"note\", \"fxLayoutAlign\", \"center center\", 3, \"right\", 4, \"ngIf\"], [\"fxFlex\", \"100\", 1, \"notes-check\"], [\"fxFlex\", \"50\", \"fxFlexOffset\", \"25\", \"fxLayoutAlign\", \"space-around\", 1, \"check-container\"], [\"fxFlex\", \"\", \"width\", \"100%\"], [\"viewBox\", \"0 0 100 100\", \"xmlns\", \"http://www.w3.org/2000/svg\", \"position\", \"relative\", \"height\", \"30px\"], [\"r\", \"5\", \"stroke-width\", \"3\", \"stroke\", \"red\", 1, \"check\"], [\"r\", \"5px\", \"stroke-width\", \"3px\", \"stroke\", \"red\", 1, \"check\"], [\"stroke-width\", \"3px\", \"stroke\", \"red\", 1, \"check\"], [\"fxFlex\", \"50\", \"fxFlexOffset\", \"25\"], [1, \"palette\"], [1, \"freth1\"], [1, \"freth\", \"first\"], [1, \"freth\", \"second\"], [1, \"freth\", \"third\"], [1, \"freth\", \"fourth\"], [1, \"string\"], [\"height\", \"100%\", \"width\", \"100%\", \"stroke-width\", \"2\", \"fill\", \"none\", \"viewBox\", \"0 0 30 800\", \"xmlns\", \"http://www.w3.org/2000/svg\", 1, \"svg\"], [\"id\", \"ref\", \"x1\", \"0%\", \"y1\", \"0%\", \"x2\", \"100%\", \"y2\", \"0%\"], [\"offset\", \"0%\", \"stop-color\", \"#fff\", \"stop-opacity\", \"1\"], [\"offset\", \"100%\", \"stop-color\", \"#fff\", \"stop-opacity\", \"1\"], [\"stroke\", \"#a67c00\", \"id\", \"E4\", 1, \"curve\"], [\"stroke\", \"#a67c00\", \"stroke-width\", \"1.6\", \"fill\", \"none\", \"viewBox\", \"0 0 30 800\", \"xmlns\", \"http://www.w3.org/2000/svg\"], [\"id\", \"A4\", 1, \"curve\"], [\"height\", \"100%\", \"width\", \"100%\", \"stroke\", \"#a67c00\", \"stroke-width\", \"1.4\", \"fill\", \"none\", \"viewBox\", \"0 0 30 800\", \"xmlns\", \"http://www.w3.org/2000/svg\"], [\"id\", \"D5\", 1, \"curve\"], [\"height\", \"100%\", \"width\", \"100%\", \"stroke\", \"#fff5\", \"stroke-width\", \"1.2\", \"fill\", \"none\", \"viewBox\", \"0 0 30 800\", \"xmlns\", \"http://www.w3.org/2000/svg\"], [\"id\", \"G5\", 1, \"curve\"], [\"height\", \"100%\", \"width\", \"100%\", \"stroke\", \"#fff5\", \"stroke-width\", \"1\", \"fill\", \"none\", \"viewBox\", \"0 0 30 800\", \"xmlns\", \"http://www.w3.org/2000/svg\"], [\"id\", \"B5\", 1, \"curve\"], [\"height\", \"100%\", \"width\", \"100%\", \"stroke\", \"#fff5\", \"stroke-width\", \"0.8\", \"fill\", \"none\", \"viewBox\", \"0 0 30 800\", \"xmlns\", \"http://www.w3.org/2000/svg\"], [\"id\", \"E6\", 1, \"curve\"], [1, \"start-button\"], [\"mat-fab\", \"\", \"color\", \"accent\", \"style\", \"z-index:999 ;\", 3, \"click\", 4, \"ngIf\"], [\"fxLayoutAlign\", \"center center\", 1, \"note\"], [\"mat-fab\", \"\", \"color\", \"accent\", 2, \"z-index\", \"999\", 3, \"click\"]],\n    template: function TunerComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3);\n        i0.ɵɵelement(4, \"fa-icon\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵelement(6, \"div\", 6)(7, \"div\", 6)(8, \"div\", 6)(9, \"div\", 6)(10, \"div\", 6)(11, \"div\", 6)(12, \"div\", 6);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(13, \"div\", 7);\n        i0.ɵɵtemplate(14, TunerComponent_div_14_Template, 3, 3, \"div\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\", 9)(16, \"div\", 10)(17, \"div\", 11);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(18, \"svg\", 12);\n        i0.ɵɵelement(19, \"circle\", 13);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(20, \"div\", 11);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(21, \"svg\", 12);\n        i0.ɵɵelement(22, \"circle\", 14);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(23, \"div\", 11);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(24, \"svg\", 12);\n        i0.ɵɵelement(25, \"circle\", 14);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(26, \"div\", 11);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(27, \"svg\", 12);\n        i0.ɵɵelement(28, \"circle\", 14);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(29, \"div\", 11);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(30, \"svg\", 12);\n        i0.ɵɵelement(31, \"circle\", 15);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(32, \"div\", 11);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(33, \"svg\", 12);\n        i0.ɵɵelement(34, \"circle\", 14);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(35, \"div\", 16)(36, \"div\", 17);\n        i0.ɵɵelement(37, \"div\", 18)(38, \"div\", 19)(39, \"div\", 20)(40, \"div\", 21)(41, \"div\", 22);\n        i0.ɵɵelementStart(42, \"div\", 23);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(43, \"svg\", 24)(44, \"defs\")(45, \"linearGradient\", 25);\n        i0.ɵɵelement(46, \"stop\", 26)(47, \"stop\", 27);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(48, \"path\", 28);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(49, \"div\", 23);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(50, \"svg\", 29);\n        i0.ɵɵelement(51, \"path\", 30);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(52, \"div\", 23);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(53, \"svg\", 31);\n        i0.ɵɵelement(54, \"path\", 32);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(55, \"div\", 23);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(56, \"svg\", 33);\n        i0.ɵɵelement(57, \"path\", 34);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(58, \"div\", 23);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(59, \"svg\", 35);\n        i0.ɵɵelement(60, \"path\", 36);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(61, \"div\", 23);\n        i0.ɵɵnamespaceSVG();\n        i0.ɵɵelementStart(62, \"svg\", 37);\n        i0.ɵɵelement(63, \"path\", 38);\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵnamespaceHTML();\n        i0.ɵɵelementStart(64, \"div\", 39);\n        i0.ɵɵtemplate(65, TunerComponent_button_65_Template, 2, 1, \"button\", 40);\n        i0.ɵɵtemplate(66, TunerComponent_button_66_Template, 2, 1, \"button\", 40);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵstyleMapInterpolate1(\"transform:translate(\", ctx.margin * 100 + \"px\", \")\");\n        i0.ɵɵclassProp(\"checked\", ctx.indicator);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"icon\", ctx.faLocation);\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngIf\", ctx.note);\n        i0.ɵɵadvance(5);\n        i0.ɵɵclassProp(\"checked\", ctx.strings.E4);\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"checked\", ctx.strings.A4);\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"checked\", ctx.strings.D5);\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"checked\", ctx.strings.G5);\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"checked\", ctx.strings.B5);\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"checked\", ctx.strings.E6);\n        i0.ɵɵadvance(14);\n        i0.ɵɵclassProp(\"checked\", ctx.strings.E4)(\"strummed\", ctx.note == \"E4\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"checked\", ctx.strings.A4)(\"strummed\", ctx.note == \"A4\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"strummed\", ctx.note == \"D5\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"strummed\", ctx.note == \"G5\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"strummed\", ctx.note == \"B5\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"strummed\", ctx.note == \"E6\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", !ctx.playing);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.playing);\n      }\n    },\n    dependencies: [i1.NgIf, i2.MatButton, i3.DefaultLayoutDirective, i3.DefaultLayoutAlignDirective, i3.DefaultFlexOffsetDirective, i3.DefaultFlexDirective, i4.FaIconComponent],\n    styles: [\".start-button[_ngcontent-%COMP%]{position:absolute;top:90vh;left:25vw;width:50vw;text-align:center;margin:0 auto;background-color:pink}.palette[_ngcontent-%COMP%]{display:flex;position:relative;justify-content:space-between;background-image:url(https://st.depositphotos.com/1003362/5105/i/950/depositphotos_51059569-stock-photo-texture-of-ash-tree.jpg);background-size:200%;background-blend-mode:multiply;overflow:hidden;width:100%;background-color:#291414}.palette[_ngcontent-%COMP%]   .freth1[_ngcontent-%COMP%]{position:absolute;height:20px;width:100%;background-color:#ccc}.palette[_ngcontent-%COMP%]   .freth[_ngcontent-%COMP%]{position:absolute;height:5px;border-radius:2.5px;width:100%;background-color:#999;box-shadow:inset 0 -2px 2px #fff}.palette[_ngcontent-%COMP%]   .first[_ngcontent-%COMP%]{top:130px}.palette[_ngcontent-%COMP%]   .second[_ngcontent-%COMP%]{top:250px}.palette[_ngcontent-%COMP%]   .third[_ngcontent-%COMP%]{top:370px}.palette[_ngcontent-%COMP%]   .fourth[_ngcontent-%COMP%]{top:490px}.distance[_ngcontent-%COMP%]{height:100px}.distance[_ngcontent-%COMP%]   .indicator[_ngcontent-%COMP%]{position:relative;top:-7px;margin:0 auto;transform-origin:50% 100%;color:#f44;height:20px;width:20px;border-radius:10px;font-size:20px;text-align:center;transition:all .5s}.distance[_ngcontent-%COMP%]   .checked[_ngcontent-%COMP%]{color:#8f6;transform:scale(1.5)!important}.distance[_ngcontent-%COMP%]   .indicator-line[_ngcontent-%COMP%]{box-sizing:border-box;height:2px;border-radius:1px;width:100%;background-color:#999}.distance[_ngcontent-%COMP%]   .indicator-line[_ngcontent-%COMP%]   .dash[_ngcontent-%COMP%]{position:relative;top:-.5px;height:2px;border-radius:.5px;max-width:1px;background-color:#999}.check-container[_ngcontent-%COMP%]{display:flex;align-items:flex-end;justify-content:space-between;padding-bottom:10px}.check-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%}.check-container[_ngcontent-%COMP%]   .check[_ngcontent-%COMP%]{transition:fill .5s 1s,stroke-dashoffset 1.5s;fill:#0f00;stroke-width:10;r:30;cx:50;cy:50;stroke-dasharray:200;stroke-dashoffset:200%;stroke-linecap:round}.check-container[_ngcontent-%COMP%]   .checked[_ngcontent-%COMP%]{stroke:#8f6;fill:#8f6;stroke-dashoffset:0%}.string[_ngcontent-%COMP%]{height:70vh;width:100%;overflow:hidden;z-index:999}.string[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:100%;width:100%;filter:drop-shadow(4px 0px 1px rgba(0,0,0,.3333333333))}.string[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .curve[_ngcontent-%COMP%]{d:path(\\\"m15 0 Q 15 225 15 800\\\");filter:drop-shadow(0px 0px 0px #ff0);transition:all 2s}.string[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .checked[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 2px rgba(255,255,255,0))}.string[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .strummed[_ngcontent-%COMP%]{animation:vibrate .1s 20}@keyframes vibrate{0%{d:path(\\\"m15 0 Q 15 225 15 800\\\")}50%{d:path(\\\"m15 0 Q 7 225 15 800\\\")}to{d:path(\\\"m15 0 Q 15 225 150850\\\")}}.note-container[_ngcontent-%COMP%]{margin:0 0 30px;min-height:120px}.note-container[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{box-sizing:unset;transform:rotate(20deg);position:relative;font-size:50px;text-align:center;transition:transform .4s,border-color .2s .2s,border-width .2s;border-width:10px;border-color:#f44;border-style:dotted;border-radius:50%;stroke-dashoffset:100%;height:120px;width:120px}.note-container[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{transition:all .4s;line-height:50px;transform:rotate(-20deg)}.note-container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{border-width:4px;border-color:#8f6;border-style:solid;transform:rotate(0)}.note-container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{line-height:50px;transform:rotate(0)}\"]\n  });\n  return TunerComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}